/*! mojo - 0.2.0 - Bernard McManus - es6-transpiler - gf544f6 - 2014-10-31 */
(function(){"use strict";function a(a){return a.length}function b(a,b){return a.indexOf(b)}function c(a){return B.isArray(a)}function d(a){return c(a)?a:a!==z?[a]:[]}function e(a,b){return d(a).forEach(b)}function f(a){return C.create(a)}function g(a,b,c){C.defineProperty(a,b,c)}function h(a,b){delete a[b]}function i(a){return C.keys(a)}function j(a){return B[F].shift.call(a)}function k(a){return B[F].pop.call(a)}function l(a,b,c){return B[F].slice.call(a,b,c)}function m(b){return b[a(b)-1]}function n(a,b){return"string"==typeof b?typeof a===b:a instanceof b}function o(a){return a||function(){}}function p(a){var b={};for(var c in a)g(b,c,{value:a[c]});return b}function q(a){return(a||{})[G]?a[G]:a}function r(a,b){return a===b?null:a}function s(a,b){var c=this;c.target=a,c.type=b,c[K]=a,c[L]=!1,c[M]=!1,c.timeStamp=D.now()}function t(a,b){var c=i(a),d=f(a);return e(c,function(b){d[b]=a[b]}),d[K]=b,d}function u(a){return J.test(a)}function v(a){return a.replace(J,"")}function w(a,b){return d(a).map(function(a){return a.func}).indexOf(b)}function x(b){for(var c,d=i(I),e=0;e<a(d);e++)if(c=I[d[e]],c===b||v(c)===b)return!0}function y(){var c=f(O);return c.__init=function(a,b){for(var c in b)a[c]=b[c];P(a)},c[H]=function(){var a=this,b=l(arguments),c=j(b),d=j(b),f=k(b),g=v(c.type)!==d;g&&a.$emit(v(c.type),f),c.type!==I.$emit||u(d)||e(a.watchers,function(a){a.$emit.apply(a,f)}),c.type===I.$emit&&u(d)&&a.$emit(v(d),f[1])},c.$set=function(a,b){var c=this;return c[a]=b,c.$emit(I.$set,[a,[a]]),c},c.$unset=function(a){var b=this;return h(b,a),b.$emit(I.$unset,[a,[a]]),b},c.$watch=function(c){var d=this;if(!n(c,A))throw new E("parent must be a MOJO");var e=c.watchers,f=b(e,d);if(0>f&&(e.push(d),d.$once(I.$deref,function(){f>=0&&e.splice(f,1)})),c.__maxWatchers)for(;a(e)>=c.__maxWatchers;)j(e).$deref();return d},c.$deref=function(){var b=this,c=b.watchers;for(b.$emit(I.$deref),b.$dispel(null,null,!0);a(c);)j(c).$deref()},c.$enq=function(a){var b=this;b.__stack.push(a)},c.$digest=function(){var b=this,c=b.__stack;if(!b.__inprog){for(b.__inprog=!0;a(c)>0;)j(c)();b.__inprog=!1}},c.maxWatchers=function(a){var b=this;return n(a,"number")&&a>=0&&(b.__maxWatchers=a),b.__maxWatchers},c}var z,A=function(a){var b=this;b.__init(b,a||{})},B=Array,C=Object,D=Date,E=Error,F="prototype",G="handleMOJO",H="__"+G,I={$set:"$$set",$unset:"$$unset",$when:"$$listener.added",$emit:"$$listener.triggered",$dispel:"$$listener.removed",$deref:"$$deref"},J=/^\${2}/,K="currentTarget",L="cancelBubble",M="defaultPrevented";s[F]={preventDefault:function(){this[M]=!0},stopPropagation:function(){this[L]=!0}};var N=function(a,b,c){var e=this;e.func=a,e.locked=!1,e.before=function(){},e.after=function(){},c=d(c),e.invoke=function(f,g){if(!f.cancelBubble){var h=l(c).concat(d(g));h.unshift(f),e.before(f,a),a.apply(b,h),e.after(f,a)}}},O={$once:function(){var a=this;return a.__when(arguments,function(b){b.before=function(b,c){a.$enq(function(){a.__remove(b.type,c)}),a.$digest()}}),a.$digest(),a},$when:function(){var a=this;return a.__when(arguments),a.$digest(),a},$emit:function(a,b,c){var d=this;return d.$enq(function(){a=a||d.__events,e(a,function(a){var f=d.__get(a),g=c?t(c,d):new s(d,a);e(f,function(a){a.invoke(g,b)}),x(a)||d.$emit(I.$emit,[a,[a,b,g]])})}),d.$digest(),d},$dispel:function(a,b,c){var d=this,f=q(b);return d.$enq(function(){a=a||d.__events,e(a,function(a){(c||!u(a))&&d.__remove(a,f,!!c)})}),d.$digest(),d},__when:function(a,b){b=o(b);var c=this,d=j(a),f=n(m(a),"function")||n(m(a),A)?k(a):c,g=a[0],h=q(f),i=r(f,h);c.$enq(function(){e(d,function(a){b(c.__add(a,h,i,g))})})},__get:function(a){var b=this,c=b.handlers;return a?d(c[a]):c},__add:function(a,b,c,d){var e=this,f=new N(b,c,d),g=e.__get(a);return g.push(f),e.handlers[a]=g,x(a)||e.$emit(I.$when,[a,[a,d,b]]),f},__remove:function(b,c,d){for(var e,f=this,g=f.__get(),i=f.__get(b),j=0;j<a(i);)e=c?w(i,c):j,e>=0&&!i[j].locked&&(i.splice(e,1),j--),j++;a(i)?g[b]=i:h(g,b),x(b)||f.$emit(I.$dispel,[b,[b,c,d]])}},P=function(a){var b=!1,c=10;g(a,"__stack",{value:[]}),g(a,"__inprog",{get:function(){return b},set:function(a){b=a}}),g(a,"__maxWatchers",{get:function(){return c},set:function(a){c=a}}),g(a,"__events",{get:function(){return i(a.handlers)}}),g(a,"handlers",{value:{}}),g(a,"watchers",{value:[]}),g(a,G,{value:o(a[G]).bind(a)}),g(a,H,{value:a[H].bind(a)}),e(i(I),function(b){var c=I[b],d=a.__add(c,a[H],a);d.locked=!0})},Q=y(),R=function(a){var b=new A;return e(a,function(a){e(i(I),function(c){b.$when(I[c],function(b,d,e){if(u(d))throw new E("private events cannot be aggregated");a[c].apply(a,e)})})}),b},S=function(a){var b=p(f(Q));for(var c in a)b[c]=a[c];return b};A[F]=p(Q),A.create=S,A.construct=P,A.aggregate=R;var T=A;"function"==typeof define&&define.amd?define([],function(){return T}):"undefined"!=typeof module&&module.exports?module.exports=T:"undefined"!=typeof this&&(this.MOJO=T)}).call(this);