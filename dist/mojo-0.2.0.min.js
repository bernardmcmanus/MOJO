/*! mojo - 0.2.0 - Bernard McManus - es6-transpiler - g30366e - 2014-11-11 */
(function(){"use strict";function a(a){return a.length}function b(a,b){return a.indexOf(b)}function c(a){return D.isArray(a)}function d(a){return c(a)?a:a!==B?[a]:[]}function e(a,b){return d(a).forEach(b)}function f(a){return E.create(a)}function g(a,b,c){E.defineProperty(a,b,c)}function h(a,b){delete a[b]}function i(a){return E.keys(a)}function j(a){return D[H].shift.call(a)}function k(a){return D[H].pop.call(a)}function l(a,b,c){return D[H].slice.call(a,b,c)}function m(b){return b[a(b)-1]}function n(a,b){return"string"==typeof b?typeof a===b:a instanceof b}function o(a){return a.split(".")}function p(a,b,c){var d=o(b),f=k(d);return e(d,function(b){a[b]=a=a[b]||{}}),function(b){return c===K.$set?a[f]=b:c===K.$unset?h(a,f):(a||{})[f]}}function q(a){return a||function(){}}function r(a){var b={};for(var c in a)g(b,c,{value:a[c]});return b}function s(a){return(a||{})[I]?a[I]:a}function t(a,b){return a===b?null:a}function u(a,b){var c=this;c.target=a,c.type=b,c[M]=a,c[N]=!1,c[O]=!1,c.timeStamp=F.now()}function v(a,b){var c=i(a),d=f(a);return e(c,function(b){d[b]=a[b]}),d[M]=b,d}function w(b){for(var c,d=i(K),e=0;e<a(d);e++)if(c=K[d[e]],c===b||y(c)===b)return!0}function x(a){return L.test(a)}function y(a){return a.replace(L,"")}function z(a,c){var e=d(a).map(function(a){return a.func});return b(e,c)}function A(){var c=f(R);return c.__init=function(a,b){for(var c in b)a[c]=b[c];S(a)},c[J]=function(){var a=this,b=l(arguments),c=j(b),d=j(b),f=k(b),g=d&&y(c.type)!==d;g&&a.$emit(y(c.type),f),c.type!==K.$emit||x(d)||e(a.watchers,function(a){a.$emit.apply(a,f)}),c.type===K.$emit&&x(d)&&a.$emit(y(d),f[1])},c.$get=function(a){var b=this;return b.__modBranch(null,a)},c.$set=function(a,b){var c=this;return c.__modBranch(K.$set,a,b),c.$emit(K.$set,[a,[a]]),c},c.$unset=function(a){var b=this,c=b.$get(a);return Q(c)&&c.$deref(),b.__modBranch(K.$unset,a),b.$emit(K.$unset,[a,[a]]),b},c.$spawn=function(a,b){var c=this,d=new C(b);return c.$watch(d).$set(a,d),d},c.$watch=function(c){function d(){c.$deref()}function e(){f.$dispel(K.$deref,d,!0)}var f=this;if(!Q(c))throw new G("child must be a $MOJO");var g=c.watchers,h=c.__maxWatchers,i=b(g,f);return 0>i&&(!h||a(g)<h)&&(g.push(f),f.$once(K.$deref,d),c.$once(K.$deref,e)),f},c.$deref=function(){var a=this;a.watchers=[],a.$emit(K.$deref),a.$dispel(null,null,!0)},c.$enq=function(a){var b=this;b.__stack.push(a)},c.$digest=function(){var b=this,c=b.__stack;if(!b.__inprog){for(b.__inprog=!0;a(c)>0;)j(c)();b.__inprog=!1}},c.maxWatchers=function(a){var b=this;return n(a,"number")&&a>=0&&(b.__maxWatchers=a),b.__maxWatchers},c.__modBranch=function(a,b,c){var d=this,e=p(d,b,a);return e(c)},c}var B,C=function(a){var b=this;b.__init(b,a||{})},D=Array,E=Object,F=Date,G=Error,H="prototype",I="handleMOJO",J="__"+I,K={$set:"$$set",$unset:"$$unset",$when:"$$when",$emit:"$$emit",$dispel:"$$dispel",$deref:"$$deref"},L=/^\${2}/,M="currentTarget",N="cancelBubble",O="defaultPrevented";u[H]={preventDefault:function(){this[O]=!0},stopPropagation:function(){this[N]=!0}};var P=function(a,b,c){var e=this;e.func=a,e.locked=!1,e.active=!0,e.events=[],e.before=function(){},e.after=function(){},c=d(c),e.invoke=function(f,g){if(e.active&&!f.cancelBubble){var h=l(c).concat(d(g));h.unshift(f),e.before(f,a),a.apply(b,h),e.after(f,a)}}},Q=function(a){return n(a,"object")&&J in a},R={$once:function(){var a=this,b=[];return a.__when(arguments,function(c){b.push(c),c.before=function(b,d){a.$dispel(c.events,d,!0)},c.after=function(){e(b,function(a){a.active=!1})}}),a.$digest(),a},$when:function(){var a=this;return a.__when(arguments),a.$digest(),a},$emit:function(a,b,c){var d=this;return d.$enq(function(){a=a||d.__events,e(a,function(a){var f=d.__get(a),g=c?v(c,d):new u(d,a);e(f,function(a){a.invoke(g,b)}),w(a)||d.$emit(K.$emit,[a,[a,b,g]])})}),d.$digest(),d},$dispel:function(a,b,c){var d=this,f=s(b);return d.$enq(function(){a=a||d.__events,e(a,function(a){(c||!x(a))&&d.__remove(a,f,!!c)})}),d.$digest(),d},__when:function(a,b){b=q(b);var c=this,f=j(a),g=n(m(a),"function")||Q(m(a))?k(a):c,h=a[0],i=s(g),l=t(g,i);c.$enq(function(){e(f,function(a){var e=c.__add(a,i,l,h);e.events=d(f),b(e)})})},__get:function(a){var b=this,c=b.handlers;return a?d(c[a]):c},__add:function(a,b,c,d){var e=this,f=new P(b,c,d),g=e.__get(a);return g.push(f),e.handlers[a]=g,w(a)||e.$emit(K.$when,[a,[a,d,b]]),f},__remove:function(b,c,d){for(var e,f=this,g=f.__get(),i=f.__get(b),j=0;j<a(i);)e=c?z(i,c):j,e>=0&&!i[j].locked&&(i.splice(e,1),j--),j++;a(i)?g[b]=i:h(g,b),w(b)||f.$emit(K.$dispel,[b,[b,c,d]])}},S=function(a){var b=!1,d=10,f=[];g(a,"__stack",{value:[]}),g(a,"__inprog",{get:function(){return b},set:function(a){b=a}}),g(a,"__maxWatchers",{get:function(){return d},set:function(a){d=a}}),g(a,"__events",{get:function(){return i(a.handlers)}}),g(a,"handlers",{value:{}}),g(a,"watchers",{get:function(){return f},set:function(a){f=c(a)?a:[]}}),g(a,I,{value:q(a[I]).bind(a)}),g(a,J,{value:a[J].bind(a)}),e(i(K),function(b){var c=K[b],d=a.__add(c,a[J],a);d.locked=!0})},T=A(),U=function(a){var b=new C;return e(a,function(a){e(i(K),function(c){b.$when(K[c],function(b,d,e){if(x(d))throw new G("private events cannot be aggregated");a[c].apply(a,e)})})}),b},V=function(a){var b=r(f(T));for(var c in a)b[c]=a[c];return b};C[H]=r(T),C.isMOJO=Q,C.create=V,C.construct=S,C.aggregate=U;var W=C;"function"==typeof define&&define.amd?define([],function(){return W}):"undefined"!=typeof module&&module.exports?module.exports=W:"undefined"!=typeof this&&(this.$MOJO=W)}).call(this);