/*! mojo - 0.2.0 - Bernard McManus - working - g0054f2 - 2014-10-22 */
function MOJO(a){var b=this;b.__init(b,a||{})}MOJO.__ready=function(){MOJO.inject("prototype",[MOJO,"Event","when","construct","ocreate","shift","pop","slice","length","del","EVENTS"],function(a,b,c,d,e,f,g,h,i,j,k){var l=e(c);return l.__init=function(a,b){for(var c in b)a[c]=b[c];d(a)},l.__handleMOJO=function(){var a=this,c=h(arguments),d=f(c),e=f(c),i=g(c),j=b.getPublic(d.type)!==e;j&&a.$emit(b.getPublic(d.type),i),d.type===k.$emit&&b.isPrivate(e)&&a.$emit(b.getPublic(e),g(i))},l.handleMOJO=function(){},l.$set=function(a,b){var c=this;return c[a]=b,c.$emit(k.set,[a,[a]]),c},l.$unset=function(a){var b=this;return j(b,a),b.$emit(k.unset,[a,[a]]),b},l.$subscribe=function(){},l.$enq=function(a){var b=this;b.stack.push(a)},l.$digest=function(){var a=this,b=a.stack;if(!a.inprog){for(a.inprog=!0;i(b)>0;)f(b)();a.inprog=!1}},j(a,"__ready"),l})},MOJO.shared=function(a,b){function c(a){return a.length}function d(a){return b[m].shift.call(a)}function e(a){return b[m].pop.call(a)}function f(a,c,d){return b[m].slice.call(a,c,d)}function g(a,b){return"string"==typeof b?typeof a===b:a instanceof b}function h(a,b){return a.hasOwnProperty(b)}function i(a){return b.isArray(a)}function j(a){return i(a)?a:a!==l?[a]:[]}function k(a,b){return j(a).forEach(b)}var l,m="prototype",n="handleMOJO",o="$$listener";return{PROTO:m,EVENTS:{set:"$$set",unset:"$$unset",$when:o+".added",$emit:o+".triggered",$dispel:o+".removed"},ocreate:function(b){return a.create(b)},defProp:function(b,c,d){a.defineProperty(b,c,d)},del:function(a,b){delete a[b]},length:c,keys:function(b){return a.keys(b)},shift:d,pop:e,slice:f,is:g,has:h,isArray:i,ensureArray:j,forEach:k,ensureFunc:function(a){return a||function(){}},getHandlerFunc:function(a){return(a||{})[n]?a[n]:a}}}(Object,Array),MOJO.inject=function(a){function b(){var b=arguments,g=d(b),h=d(b),i=d(b);h=h.map(function(b){var d;return d=f(b,"string")?e(c,b)?c[b]:a[b]:b}),a[i]=g.apply(null,h)}var c=a.shared,d=c.pop,e=c.has,f=c.is;return b}(MOJO),MOJO.inject("EventHandler",["ensureArray"],function(a){function b(b,c,d){var e=this;e.func=b,e.locked=!1,e.before=function(){},e.after=function(){},d=a(d),e.invoke=function(f,g){if(!f.cancelBubble){var h=d.slice(0).concat(a(g));h.unshift(f),e.before(f,b),b.apply(c,h),e.after(f,b)}}}return b}),MOJO.inject("Event",[Date,"forEach","getHandlerFunc","keys","ocreate","PROTO"],function(a,b,c,d,e,f){function g(b,c){var d=this;d.target=b,d.type=c,d[i]=b,d[j]=!1,d[k]=!1,d.timeStamp=a.now()}var h=/^\${2}/,i="currentTarget",j="cancelBubble",k="defaultPrevented";return g.clone=function(a,c){var f=d(a),g=e(a);return b(f,function(b){g[b]=a[b]}),g[i]=c,g},g.isPrivate=function(a){return h.test(a)},g.getPublic=function(a){return a.replace(h,"")},g[f]={preventDefault:function(){this[k]=!0},stopPropagation:function(){this[j]=!0}},g}),MOJO.inject("when",["EventHandler","Event","keys","ocreate","shift","pop","ensureArray","forEach","length","ensureFunc","getHandlerFunc","isArray","is","del","EVENTS"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(a,b){return g(a).map(function(a){return a.func}).indexOf(b)}function q(a,b){return a===b?null:a}function r(a){for(var c,d=Object.keys(o),e=0;e<d.length;e++)if(c=o[d[e]],c===a||b.getPublic(c)===a)return!0}return{$once:function(){var a=this;return a.__when(arguments,function(b){b.before=function(b,c){a.$enq(function(){a.__remove(b.type,c)}),a.$digest()}}),a.$digest(),a},$when:function(){var a=this;return a.__when(arguments),a.$digest(),a},$emit:function(a,c,d){var e=this;return e.$enq(function(){a=e._ensureEType(a),h(a,function(a){var f=e.__get(a),g=d?b.clone(d,e):new b(e,a);h(f,function(a){a.invoke(g,c)}),r(a)||e.$emit(o.$emit,[a,[a,g,c]])})}),e.$digest(),e},$dispel:function(a,c,d){var e=this,f=k(c);return e.$enq(function(){a=e._ensureEType(a),h(a,function(a){(d||!b.isPrivate(a))&&e.__remove(a,f)})}),e.$digest(),e},__when:function(a,b){b=j(b);var c=this,d=e(a),g=m(a[0],"function")||m(a[0],MOJO)?f(a):c,i=a[0],l=k(g),n=q(g,l);c.$enq(function(){h(d,function(a){b(c.__add(a,l,n,i))})})},__get:function(a){var b=this,c=b.handlers;return a?g(c[a]):c},__add:function(b,c,d,e){var f=this,g=new a(c,d,e),h=f.__get(b);return h.push(g),f.handlers[b]=h,r(b)||f.$emit(o.$when,[b,[b,c,e]]),g},__remove:function(a,b){for(var c,d=this,e=d.__get(),f=d.__get(a),g=0;g<i(f);)c=b?p(f,b):g,c>=0&&!f[g].locked&&(f.splice(c,1),g--),g++;i(f)?e[a]=f:n(e,a),r(a)||d.$emit(o.$dispel,[a,[a,b]])},_ensureEType:function(a){return a||c(this.handlers)}}}),MOJO.inject("create",[MOJO,"ocreate","PROTO"],function(a,b,c){function d(d){var e=b(a[c]);for(var f in d)e[f]=d[f];return e}return d}),MOJO.inject("construct",["keys","defProp","length","EVENTS"],function(a,b,c,d){function e(c){var e=!1;b(c,"inprog",{get:function(){return e},set:function(a){e=a}}),b(c,"handlers",{value:{}}),b(c,"stack",{value:[]}),b(c,f,{value:c[f].bind(c)}),b(c,g,{value:c[g].bind(c)}),a(d).forEach(function(a){var b=d[a],e=c.__add(b,c[g],c);e.locked=!0})}var f="handleMOJO",g="__"+f;return e}),MOJO.inject("aggregate",[MOJO,"forEach","EVENTS"],function(a){function b(){var b=new a;return b}return b}),function(a){"object"==typeof exports?module.exports=a:window.MOJO=a,a.__ready()}(MOJO);