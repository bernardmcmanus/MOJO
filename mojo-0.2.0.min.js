/*! mojo - 0.2.0 - Bernard McManus - working - g75754c - 2014-10-17 */
function MOJO(a){var b=this;b.__init(b,a||{})}MOJO.__ready=function(){MOJO.inject("prototype",[MOJO,"Event","when","construct","ocreate","shift","length","del","EVENTS"],function(a,b,c,d,e,f,g,h,i){var j=e(c);return j.__init=function(a,b){for(var c in b)a[c]=b[c];d(a)},j.__handleMOJO=function(){{var a=arguments;f(a)}},j.handleMOJO=function(){},j.$set=function(a,b){var c=this;return c[a]=b,c.$emit(i.set,a),c},j.$unset=function(a){var b=this;return h(b,a),b.$emit(i.unset,a),b},j.$subscribe=function(){},j.$enq=function(a){var b=this;b.stack.push(a)},j.$digest=function(){var a=this,b=a.stack;if(!a.inprog){for(a.inprog=!0;g(b)>0;)f(b)();a.inprog=!1}},h(a,"__ready"),j})},MOJO.shared=function(a,b){function c(a){return a.length}function d(a){return b[l].shift.call(a)}function e(a){return b[l].pop.call(a)}function f(a,b){return typeof a===b}function g(a,b){return a.hasOwnProperty(b)}function h(a){return b.isArray(a)}function i(a){return h(a)?a:a!==k?[a]:[]}function j(a,b){return i(a).forEach(b)}var k,l="prototype",m="handleMOJO",n="$$listener";return{PROTO:l,EVENTS:{set:"$$set",unset:"$$unset",$when:n+".added",$emit:n+".triggered",$dispel:n+".removed"},ocreate:function(b){return a.create(b)},defProp:function(b,c,d){a.defineProperty(b,c,d)},del:function(a,b){delete a[b]},length:c,keys:function(b){return a.keys(b)},shift:d,pop:e,is:f,has:g,isArray:h,ensureArray:i,forEach:j,getHandlerFunc:function(a){return(a||{})[m]?a[m]:a}}}(Object,Array),MOJO.inject=function(a){function b(){var b=arguments,g=d(b),h=d(b),i=d(b);h=h.map(function(b){var d;return d=f(b,"string")?e(c,b)?c[b]:a[b]:b}),a[i]=g.apply(null,h)}var c=a.shared,d=c.pop,e=c.has,f=c.is;return b}(MOJO),MOJO.inject("EventHandler",["ensureArray"],function(a){function b(b,c,d){var e=this;e.func=b,e.active=!0,e.locked=!1,e.callback=function(){},d=a(d),e.invoke=function(f,g){if(e.active&&!f.cancelBubble){var h=d.slice(0).concat(a(g));h.unshift(f),b.apply(c,h),e.callback(f,b)}}}return b}),MOJO.inject("Event",[Date,"forEach","getHandlerFunc","keys","ocreate","PROTO"],function(a,b,c,d,e,f){function g(b,c){var d=this;d.target=b,d.type=c,d[i]=b,d[j]=!1,d[k]=!1,d.timeStamp=a.now()}var h=/^\${2}/,i="currentTarget",j="cancelBubble",k="defaultPrevented";return g.clone=function(a,c){var f=d(a),g=e(a);return b(f,function(b){g[b]=a[b]}),g[i]=c,g},g.isPrivate=function(a){return h.test(a)},g.getPublic=function(a){return a.replace(h,"")},g[f]={preventDefault:function(){this[k]=!0},stopPropagation:function(){this[j]=!0}},g}),MOJO.inject("when",["EventHandler","Event","keys","ocreate","shift","pop","ensureArray","length","getHandlerFunc","isArray","del","EVENTS"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a,b){return g(a).map(function(a){return a.func}).indexOf(b)}function n(a,b){g(a).forEach(b)}function o(a,b){return a===b?null:a}return{$once:function(){var a=this,b=a.__when(arguments);return b.forEach(function(a){a.callback=function(){this.active=!1}}),a},$when:function(){var a=this;return a.__when(arguments),a},$emit:function(a,c,d){var e=this;return a=e._ensureEType(a),n(a,function(a){var f=e.__get(a,!0),g=d?b.clone(d,e):new b(e,a);f.forEach(function(a){e.$enq(function(){a.invoke(g,c)})}),e.$enq(function(){f.forEach(function(b){b.active||e.__remove(a,b.func)})}),b.isPrivate(a)||e.$emit(l.$emit,[a,g,c]),e.$digest()}),e},$dispel:function(a,c,d){var e=this,f=(e.__get(),i(c));return a=e._ensureEType(a),n(a,function(a){(d||!b.isPrivate(a))&&e.__remove(a,f)}),e},__when:function(a){var b=this,c=e(a),d=f(a),g=a[0],h=[],j=i(d),k=o(d,j);return n(c,function(a){h.push(b.__add(a,j,k,g))}),h},__get:function(a,b){var c=this,e=c.handlers,f=a?g(e[a]):e;return b&&(f=j(f)?f.slice(0):d(f)),f},__add:function(c,d,e,f){var g=this,h=new a(d,e,f),i=g.__get(c);return i.push(h),g.handlers[c]=i,b.isPrivate(c)||g.$emit(l.$when,[c,d,f]),h},__remove:function(a,c){for(var d,e=this,f=e.__get(),g=e.__get(a),i=0;i<h(g);)d=c?m(g,c):i,d>=0&&!g[i].locked&&(g.splice(d,1),i--),i++;h(g)?f[a]=g:k(f,a),b.isPrivate(a)||e.$emit(l.$dispel,[a,c])},_ensureEType:function(a){return a||c(this.handlers)}}}),MOJO.inject("create",[MOJO,"ocreate","PROTO"],function(a,b,c){function d(d){var e=b(a[c]);for(var f in d)e[f]=d[f];return e}return d}),MOJO.inject("construct",["keys","defProp","length","EVENTS"],function(a,b,c,d){function e(c){var e=!1;b(c,"inprog",{get:function(){return e},set:function(a){e=a}}),b(c,"handlers",{value:{}}),b(c,"stack",{value:[]}),b(c,f,{value:c[f].bind(c)}),b(c,g,{value:c[g].bind(c)}),a(d).forEach(function(a){var b=d[a],e=c.__add(b,c[g],c);e.locked=!0})}var f="handleMOJO",g="__"+f;return e}),MOJO.inject("aggregate",[MOJO,"forEach","EVENTS"],function(a,b,c){function d(d){var e=new a;return b(d,function(a){e.$when(c.$when,function(b,c,d,e){a.$when(c,e,d)}).$when(c.$emit,function(b,c,d,e){a.$emit(c,e,d)}).$when(c.$dispel,function(b,c,d){a.$dispel(c,d)}).$when(c.$set,function(b,c){a.set(c,e[c])}).$when(c.$unset,function(b,c){a.unset(c)})}),e}return d}),function(a){"object"==typeof exports?module.exports=a:window.MOJO=a,a.__ready()}(MOJO);