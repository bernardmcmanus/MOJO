/*! mojo - 0.2.0 - Bernard McManus - hotfix - gf7ce94 - 2014-10-16 */
function MOJO(a){var b=this;b.__init(b,a||{})}MOJO.__ready=function(){MOJO.inject([MOJO,"when","construct","ocreate","del","EVENTS","PROTO"],function(a,b,c,d,e,f,g){var h=a[g]=d(b);h.__init=function(a,b){for(var d in b)a[d]=b[d];c(a)},h.__handleMOJO=function(a){switch(a.type){case f.$when:break;case f.$dispel:break;case f.set:break;case f.unset:}},h.set=function(a,b){var c=this;return c[a]=b,c.$emit(f.set,a),c},h.unset=function(a){var b=this;return e(b,a),b.$emit(f.unset,a),b},e(a,"__ready")})},MOJO.shared=function(a,b){function c(a){return a.length}function d(a){return b[l].shift.call(a)}function e(a){return b[l].pop.call(a)}function f(a,b){return typeof a===b}function g(a,b){return a.hasOwnProperty(b)}function h(a){return b.isArray(a)}function i(a){return h(a)?a:a!==k?[a]:[]}function j(a,b){return i(a).forEach(b)}var k,l="prototype",m="handleMOJO";return{PROTO:l,EVENTS:{set:"$$set",unset:"$$unset",$when:"$$listener.added",$emit:"$$listener.triggered",$dispel:"$$listener.removed"},ocreate:function(b){return a.create(b)},defProp:function(b,c,d){a.defineProperty(b,c,d)},del:function(a,b){delete a[b]},length:c,keys:function(b){return a.keys(b)},shift:d,pop:e,is:f,has:g,isArray:h,ensureArray:i,forEach:j,descriptor:function(a,b){return{get:a,set:b,configurable:!0}},getHandlerFunc:function(a){return(a||{})[m]?a[m]:a}}}(Object,Array),MOJO.inject=function(a){function b(){var b=arguments,g=d(b),h=d(b);return h=h.map(function(b){var d;return d=f(b,"string")?e(c,b)?c[b]:a[b]:b}),g.apply(null,h)}var c=a.shared,d=c.pop,e=c.has,f=c.is;return b}(MOJO),MOJO.EventHandler=MOJO.inject(["defProp","ensureArray","PROTO"],function(a,b){function c(c,d,e){var f=this;f.func=c,f.active=!0,f.callback=function(){},e=b(e),a(f,"locked",{value:d&&d.__handleMOJO===c}),f.invoke=function(a,g){if(f.active){var h=e.slice(0).concat(b(g));h.unshift(a),c.apply(d,h),f.callback(a,c)}}}return c}),MOJO.Event=MOJO.inject([Date,"ensureArray","getHandlerFunc","PROTO"],function(a,b,c,d){function e(b,c){var d=this;d.target=b,d.currentTarget=b,d.type=c,d[f]=!1,d[g]=!1,d.timeStamp=a.now()}var f="cancelBubble",g="defaultPrevented";return e.clone=function(a,b){var c=Object.keys(a),d=Object.create(a);return c.forEach(function(b){d[b]=a[b]}),d.currentTarget=b,d},e.isPrivate=function(a){return/^\${2}/.test(a)},e[d]={preventDefault:function(){this[g]=!0},stopPropagation:function(){this[f]=!0}},e}),MOJO.when=MOJO.inject(["EventHandler","Event","keys","ocreate","shift","pop","ensureArray","length","getHandlerFunc","isArray","del","EVENTS"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a,b){return g(a).map(function(a){return a.func}).indexOf(b)}function n(a,b){g(a).forEach(b)}function o(a,b){return a===b?null:a}return{$once:function(){var a=this,b=a.__when(arguments);return b.forEach(function(a){a.callback=function(){this.active=!1}}),a},$when:function(){var a=this;return a.__when(arguments),a},$emit:function(a,c,d){var e=this;return a=e._ensureEType(a),n(a,function(a){var f=e.__get(a,!0),g=d?b.clone(d,e):new b(e,a);f.filter(function(a){return a.invoke(g,c),!a.active}).forEach(function(b){e.__remove(a,b.func)}),b.isPrivate(a)||e.$emit(l.$emit,[a,g,c])}),e},$dispel:function(a,b){var c=this,d=(c.__get(),i(b));return a=c._ensureEType(a),n(a,function(a){c.__remove(a,d)}),c},__when:function(a){var b=this,c=e(a),d=f(a),g=a[0],h=[],j=i(d),k=o(d,j);return n(c,function(a){h.push(b.__add(a,j,k,g))}),h},__get:function(a,b){var c=this,e=c.handlers,f=a?g(e[a]):e;return b&&(f=j(f)?f.slice(0):d(f)),f},__add:function(c,d,e,f){var g=this,h=new a(d,e,f),i=g.__get(c);return i.push(h),g.handlers[c]=i,b.isPrivate(c)||g.$emit(l.$when,[c,d,f]),h},__remove:function(a,c){for(var d,e=this,f=e.__get(),g=e.__get(a),i=0;i<h(g);)d=c?m(g,c):i,d>=0&&!g[d].locked&&(g.splice(d,1),i--),i++;h(g)?f[a]=g:k(f,a),b.isPrivate(a)||e.$emit(l.$dispel,a)},_ensureEType:function(a){return a||c(this.handlers)}}}),MOJO.create=MOJO.inject([MOJO,"ocreate","PROTO"],function(a,b,c){function d(d){var e=b(a[c]);for(var f in d)e[f]=d[f];return e}return d}),MOJO.construct=MOJO.inject(["keys","defProp","descriptor","length","EVENTS"],function(a,b,c,d,e){function f(d){var f={};b(d,"handlers",c(function(){return f})),b(d,h,{value:d[h].bind(d)}),b(d,g,{value:(d[g]||function(){}).bind(d)}),a(e).forEach(function(a){var b=e[a];d.__add(b,d[h],d)})}var g="handleMOJO",h="__"+g;return f}),function(a,b){var c=b.when;b.Create=b.create,b.Construct=b.construct,b.Each=function(b,c){a.keys(b).forEach(function(a,d){c(b[a],a,d)})},c.when=c.$when,c.once=c.$once,c.happen=c.$emit,c.dispel=c.$dispel}(Object,MOJO),function(a){"object"==typeof exports?module.exports=a:window.MOJO=a,a.__ready()}(MOJO);