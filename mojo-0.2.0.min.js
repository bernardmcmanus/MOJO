/*! mojo - 0.2.0 - Bernard McManus - nightly - g727d74 - 2014-09-26 */
function MOJO(a){var b=this;b.__init(b,a||{})}MOJO.__ready=function(){MOJO.inject([MOJO,"when","construct","ocreate","del","PROTO"],function(a,b,c,d,e,f){var g=a[f]=d(b);g.__init=function(a,b){for(var d in b)a[d]=b[d];c(a)},g.set=function(a,b){var c=this;return c[a]=b,c.happen("set",a),c},g.unset=function(a){var b=this;return e(b,a),b.happen("unset",a),b},e(a,"__ready")})},MOJO.shared=function(a,b){function c(a){return a.length}function d(a){return b[k].shift.call(a)}function e(a){return b[k].pop.call(a)}function f(a,b){return typeof a===b}function g(a,b){return a.hasOwnProperty(b)}function h(a){return b.isArray(a)}function i(a){return h(a)?a:a!==j?[a]:[]}var j,k="prototype",l="handleMOJO";return{PROTO:k,ocreate:function(b){return a.create(b)},defProp:function(b,c,d){a.defineProperty(b,c,d)},del:function(a,b){delete a[b]},length:c,keys:function(b){return a.keys(b)},shift:d,pop:e,is:f,has:g,isArray:h,ensureArray:i,descriptor:function(a,b){return{get:a,set:b,configurable:!0}},getHandlerFunc:function(a){return(a||{})[l]?a[l]:a}}}(Object,Array),MOJO.inject=function(a){function b(){var b=arguments,g=d(b),h=d(b);return h=h.map(function(b){var d;return d=f(b,"string")?e(c,b)?c[b]:a[b]:b}),g.apply(null,h)}var c=a.shared,d=c.pop,e=c.has,f=c.is;return b}(MOJO),MOJO.EventHandler=MOJO.inject(["ensureArray","PROTO"],function(a){function b(b,c,d){var e=this;e.func=b,e.active=!0,e.callback=function(){},d=a(d),e.invoke=function(f,g){!e.active||f.isBreak||f.isSkip(b)||(d=d.concat(a(g)),d.unshift(f),b.apply(c,d),e.callback(f,b))}}return b}),MOJO.Event=MOJO.inject([Date,"ensureArray","getHandlerFunc","PROTO"],function(a,b,c,d){function e(b,c){var d=this;d.isBreak=!1,d.cancelBubble=!1,d.defaultPrevented=!1,d.skipHandlers=[],d.target=b,d.type=c,d.timeStamp=a.now()}return e[d]={skip:function(a){var d=this.skipHandlers;b(a).forEach(function(a){d.push(c(a))})},isSkip:function(a){return this.skipHandlers.indexOf(a)>=0},"break":function(){this.isBreak=!0},preventDefault:function(){this.defaultPrevented=!0},stopPropagation:function(){this.cancelBubble=!0}},e}),MOJO.when=MOJO.inject(["EventHandler","Event","keys","ocreate","shift","pop","ensureArray","length","getHandlerFunc","isArray","del"],function(a,b,c,d,e,f,g,h,i,j,k){function l(a,b){return g(a).map(function(a){return a.func}).indexOf(b)}function m(a,b){g(a).forEach(b)}function n(a,b){return a===b?null:a}return{once:function(){var a=this,b=a.__when(arguments);return b.forEach(function(a){a.callback=function(){this.active=!1}}),a},when:function(){var a=this;return a.__when(arguments),a},happen:function(a,c){var d=this;return a=d._ensureEType(a),m(a,function(a){var e=d.__get(a,!0),f=new b(d,a);e.filter(function(a){return a.invoke(f,c),!a.active}).forEach(function(b){d.__remove(a,b.func)})}),d},dispel:function(a,b){var c=this,d=(c.__get(),i(b));return a=c._ensureEType(a),m(a,function(a){c.__remove(a,d)}),c},__when:function(a){var b=this,c=e(a),d=f(a),g=a[0],h=[],j=i(d),k=n(d,j);return m(c,function(a){h.push(b.__add(a,j,k,g))}),h},_ensureEType:function(a){return a||c(this.handlers)},__get:function(a,b){var c=this,e=c.handlers,f=a?g(e[a]):e;return b&&(f=j(f)?f.slice(0):d(f)),f},__add:function(b,c,d,e){var f=this,g=new a(c,d,e),h=f.__get(b);return h.push(g),f.handlers[b]=h,g},__remove:function(a,b){var c=this,d=c.__get(),e=c.__get(a),f=l(e,b);f>=0&&e.splice(f,1),h(e)&&b?d[a]=e:k(d,a)}}}),MOJO.create=MOJO.inject([MOJO,"ocreate","PROTO"],function(a,b,c){function d(d){var e=b(a[c]);for(var f in d)e[f]=d[f];return e}return d}),MOJO.construct=MOJO.inject([Object,"keys","descriptor","length"],function(a,b,c){function d(b){var d={};a.defineProperties(b,{handlers:c(function(){return d}),handleMOJO:{value:(b.handleMOJO||function(){}).bind(b),configurable:!0}})}return d}),function(a){"object"==typeof exports?module.exports=a:window.MOJO=a,a.__ready()}(MOJO);